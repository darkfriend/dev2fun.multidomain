(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{haI8:function(e,t,s){"use strict";s.r(t);var l=s("yXPU"),n=s.n(l),a=s("o0o1"),i=s.n(a),c=s("GXCG"),r={name:"urlrewrite",components:{btn:function(){return s.e(3).then(s.bind(null,"b5O1"))}},props:{value:Object,locale:Object,siteId:{type:String,require:!0}},data:function(){return{domainKeysLocal:[],items:[],afterItems:[],selectItems:[],selectItemsRestore:[],loaded:!1}},computed:{inputValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},isDirectoryMode:function(){return"directory"===this.inputValue.logic_subdomain},afterItem:function(){var e=this;return function(t){var s,l,n;return!e.isEmpty(null!==(s=null===(l=t.CONDITION)||void 0===l||null===(n=l.match(/(\?<subdomain>)/))||void 0===n?void 0:n[1])&&void 0!==s?s:null)}},isSupportPath:function(){var e=this;return function(t){return e.items.filter((function(s){var l,n,a;return s.PATH===t&&!e.isEmpty(null!==(l=null===(n=s.CONDITION)||void 0===n||null===(a=n.match(/(\?<subdomain>)/))||void 0===a?void 0:a[1])&&void 0!==l?l:null)})).length>0}},isSupportRule:function(){var e=this;return function(t){return e.items.filter((function(s){var l,n,a;return s.RULE===t&&!e.isEmpty(null!==(l=null===(n=s.CONDITION)||void 0===n||null===(a=n.match(/(\?<subdomain>)/))||void 0===a?void 0:a[1])&&void 0!==l?l:null)})).length>0}}},created:function(){this.init()},methods:{addItem:function(e){var t;null!==(t=!(null!=e&&e.PATH))&&void 0!==t&&t||this.toggleSelectedPath(e.PATH)},toggleSelectedPath:function(e){this.selectItems.includes(e)?this.selectItems.slice(this.selectItems.indexOf(e),1):this.selectItems.push(e)},addItemRestore:function(e){var t;null!==(t=!(null!=e&&e.PATH))&&void 0!==t&&t||this.toggleSelectedRestorePath(e.PATH)},toggleSelectedRestorePath:function(e){this.selectItemsRestore.includes(e)?this.selectItemsRestore.slice(this.selectItemsRestore.indexOf(e),1):this.selectItemsRestore.push(e)},init:function(){var e=this;return n()(i.a.mark((function t(){var s,l,n,a,r,o,u,d;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.a.post(location.href,{action:"getUrlrewrite",sessid:BX.bitrix_sessid(),typeSubdomain:e.inputValue.type_subdomain,logicSubdomain:e.inputValue.logic_subdomain,siteId:e.siteId});case 3:if(o=t.sent,null===(s=!(null!=o&&o.success))||void 0===s||!s){t.next=6;break}throw new Error(null!==(u=null===(d=o.msg)||void 0===d?void 0:d.exception)&&void 0!==u?u:o.msg);case 6:e.afterItems=null!==(l=null==o||null===(n=o.data)||void 0===n?void 0:n.afterItems)&&void 0!==l?l:[],e.items=null!==(a=null==o||null===(r=o.data)||void 0===r?void 0:r.items)&&void 0!==a?a:[],e.loaded=!0,t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),e.$emit("error",t.t0.message);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))()},btnUpdateUrlrewriteValue:function(e){return"".concat(this.locale.LABEL_URLREWRITE_UPDATE," urlrewrite (").concat(e,")")},updateUrlrewrite:function(){this.updateUrlrewriteAjax()},updateUrlrewriteAjax:function(){var e=this;return n()(i.a.mark((function t(){var s,l;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.a.post(location.href,{action:"updateUrlrewrite",sessid:BX.bitrix_sessid(),typeSubdomain:e.inputValue.type_subdomain,logicSubdomain:e.inputValue.logic_subdomain,siteId:e.siteId,selectItems:e.selectItems,selectItemsRestore:e.selectItemsRestore});case 3:if((s=t.sent).success){t.next=6;break}throw new Error(null!==(l=s.msg.exception)&&void 0!==l?l:s.msg);case 6:return e.resetSelected(),t.next=9,e.init();case 9:e.$forceUpdate(),e.$emit("showMessage",s.data),e.$emit("saved",!0,s.data),t.next=19;break;case 14:t.prev=14,t.t0=t.catch(0),e.$emit("error",t.t0.message),e.$emit("saved",!1,t.t0.message);case 19:return t.prev=19,t.finish(19);case 21:case"end":return t.stop()}}),t,null,[[0,14,19,21]])})))()},btnRestoreUrlrewriteValue:function(e){return"".concat(this.locale.LABEL_URLREWRITE_RESTORE," urlrewrite (").concat(e,")")},restoreUrlrewrite:function(e){this.restoreUrlrewriteAjax(e)},restoreUrlrewriteAjax:function(e){var t=this;return n()(i.a.mark((function s(){var l,n,a;return i.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,l=t.settings,t.isEmpty(l.url)&&(l.url=location.href),s.next=5,c.a.post(l.url,{action:"restoreUrlrewrite",sessid:BX.bitrix_sessid(),typeSubdomain:t.inputValue.type_subdomain,logicSubdomain:t.inputValue.logic_subdomain,siteId:e});case 5:if((n=s.sent).success){s.next=8;break}throw new Error(null!==(a=n.msg.exception)&&void 0!==a?a:n.msg);case 8:return t.resetSelected(),s.next=11,t.init();case 11:t.$forceUpdate(),t.$emit("showMessage",n.data),t.$emit("saved",!0,n.data),s.next=21;break;case 16:s.prev=16,s.t0=s.catch(0),t.$emit("error",s.t0.message),t.$emit("saved",!1,s.t0.message);case 21:case"end":return s.stop()}}),s,null,[[0,16]])})))()},resetSelected:function(){this.selectItems=[],this.selectItemsRestore=[]}}},o=s("KHd+"),u=Object(o.a)(r,(function(){var e=this,t=e._self._c;return e.loaded?t("table",{staticClass:"c-table c-table--striped",staticStyle:{"max-width":"800px",margin:"0 auto"}},[t("thead",{staticClass:"c-table__head"},[t("tr",{staticClass:"c-table__row c-table__row--heading"},[t("th",{staticClass:"c-table__cell"},[e._v("urlrewrite.php")]),e._v(" "),t("th",{staticClass:"c-table__cell"},[e._v("\n                "+e._s(e.locale.LABEL_URLREWRITE_ACTION)+"\n            ")])])]),e._v(" "),t("tbody",{staticClass:"c-table__body"},[e._l(e.items,(function(s){return["/index.php"!==s.PATH&&"/$2/index.php"!==s.RULE?t("tr",{staticClass:"c-table__row"},[t("td",{staticClass:"c-table__cell"},[t("code",[e._v("\n                        CONDITION: "+e._s(s.CONDITION)),t("br"),e._v("\n                        RULE: "+e._s(s.RULE)),t("br"),e._v("\n                        ID: "+e._s(s.ID)),t("br"),e._v("\n                        PATH: "+e._s(s.PATH)+"\n                    ")])]),e._v(" "),t("td",{staticClass:"c-table__cell"},[e.afterItem(s)?t("label",{staticClass:"c-field c-field--choice"},[t("input",{attrs:{type:"checkbox",value:"2",name:"selectItemsRestore"},domProps:{checked:e.selectItemsRestore.includes(s.PATH)},on:{change:function(t){return t.preventDefault(),e.addItemRestore(s)}}}),e._v(" "+e._s(e.locale.LABEL_URLREWRITE_REMOVE_SUPPORT)+"\n                    ")]):t("label",{staticClass:"c-field c-field--choice"},[t("input",{attrs:{type:"checkbox",value:"1",name:"selectItems"},domProps:{checked:e.selectItems.includes(s.PATH)},on:{change:function(t){return t.preventDefault(),e.addItem(s)}}}),e._v(" "+e._s(e.locale.LABEL_URLREWRITE_ADD_SUPPORT)+"\n                    ")])])]):e._e()]})),e._v(" "),t("tr",{staticClass:"c-table__row"},[t("td",{staticClass:"c-table__cell"},[e._v("\n                "+e._s(e.locale.LABEL_URLREWRITE_MAIN_PAGE)+"\n            ")]),e._v(" "),t("td",{staticClass:"c-table__cell"},[e.isSupportPath("/index.php")?t("label",{staticClass:"c-field c-field--choice"},[t("input",{attrs:{type:"checkbox",value:"2",name:"selectItemsRestore"},domProps:{checked:e.selectItemsRestore.includes("/index.php")},on:{change:function(t){return t.preventDefault(),e.toggleSelectedRestorePath("/index.php")}}}),e._v(" "+e._s(e.locale.LABEL_URLREWRITE_REMOVE_SUPPORT)+"\n                ")]):t("label",{staticClass:"c-field c-field--choice"},[t("input",{attrs:{type:"checkbox",value:"1",name:"selectItems"},domProps:{checked:e.selectItems.includes("/index.php")},on:{change:function(t){return t.preventDefault(),e.toggleSelectedPath("/index.php")}}}),e._v(" "+e._s(e.locale.LABEL_URLREWRITE_ADD_SUPPORT)+"\n                ")])])]),e._v(" "),t("tr",{staticClass:"c-table__row"},[t("td",{staticClass:"c-table__cell"},[e._v("\n                "+e._s(e.locale.LABEL_URLREWRITE_PAGES_WITH_EXTENSIONS)+"\n            ")]),e._v(" "),t("td",{staticClass:"c-table__cell"},[e.isSupportRule("/$2/$3")?t("label",{staticClass:"c-field c-field--choice"},[t("input",{attrs:{type:"checkbox",value:"2",name:"selectItemsRestore"},domProps:{checked:e.selectItemsRestore.includes("/$2/$3")},on:{change:function(t){return t.preventDefault(),e.toggleSelectedRestorePath("/$2/$3")}}}),e._v(" "+e._s(e.locale.LABEL_URLREWRITE_REMOVE_SUPPORT)+"\n                ")]):t("label",{staticClass:"c-field c-field--choice"},[t("input",{attrs:{type:"checkbox",value:"1",name:"selectItems"},domProps:{checked:e.selectItems.includes("/$2/$3")},on:{change:function(t){return t.preventDefault(),e.toggleSelectedPath("/$2/$3")}}}),e._v(" "+e._s(e.locale.LABEL_URLREWRITE_ADD_SUPPORT)+"\n                ")])])]),e._v(" "),t("tr",{staticClass:"c-table__row"},[t("td",{staticClass:"c-table__cell"},[e._v("\n                "+e._s(e.locale.LABEL_URLREWRITE_PAGES_ANOTHER)+"\n            ")]),e._v(" "),t("td",{staticClass:"c-table__cell"},[e.isSupportRule("/$2/index.php")?t("label",{staticClass:"c-field c-field--choice"},[t("input",{attrs:{type:"checkbox",value:"2",name:"selectItemsRestore"},domProps:{checked:e.selectItemsRestore.includes("/$2/index.php")},on:{change:function(t){return t.preventDefault(),e.toggleSelectedRestorePath("/$2/index.php")}}}),e._v(" "+e._s(e.locale.LABEL_URLREWRITE_REMOVE_SUPPORT)+"\n                ")]):t("label",{staticClass:"c-field c-field--choice"},[t("input",{attrs:{type:"checkbox",value:"1",name:"selectItems"},domProps:{checked:e.selectItems.includes("/$2/index.php")},on:{change:function(t){return t.preventDefault(),e.toggleSelectedPath("/$2/index.php")}}}),e._v(" "+e._s(e.locale.LABEL_URLREWRITE_ADD_SUPPORT)+"\n                ")])])]),e._v(" "),t("tr",{staticClass:"c-table__row"},[t("td",{staticClass:"c-table__cell"},[t("div",{staticStyle:{margin:"0 auto",width:"50%",display:"flex","justify-content":"space-between"}},[t("btn",{staticStyle:{margin:"0 auto",display:"block"},attrs:{type:"button",value:e.btnUpdateUrlrewriteValue(e.siteId),title:e.btnUpdateUrlrewriteValue(e.siteId),"class-name":"adm-btn-save"},on:{click:e.updateUrlrewrite}}),e._v(" "),t("btn",{staticStyle:{margin:"0 auto",display:"block"},attrs:{type:"button",value:e.btnRestoreUrlrewriteValue(e.siteId),title:e.btnRestoreUrlrewriteValue(e.siteId)},on:{click:e.restoreUrlrewrite}})],1)])])],2)]):e._e()}),[],!1,null,"826315e0",null);t.default=u.exports}}]);